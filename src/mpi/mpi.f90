#include "hopest_f.h"

MODULE MODH_MPI
!===================================================================================================================================
! Add comments please!
!===================================================================================================================================
! MODULES
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
PRIVATE
!-----------------------------------------------------------------------------------------------------------------------------------
! GLOBAL VARIABLES 
!-----------------------------------------------------------------------------------------------------------------------------------
! Private Part ---------------------------------------------------------------------------------------------------------------------
! Public Part ----------------------------------------------------------------------------------------------------------------------
INTERFACE InitMPI
  MODULE PROCEDURE InitMPI
END INTERFACE

PUBLIC::InitMPI
!===================================================================================================================================

CONTAINS

SUBROUTINE InitMPI()
!===================================================================================================================================
! Basic MPI initialization. 
!===================================================================================================================================
! MODULES
USE MODH_Globals
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES 
!===================================================================================================================================
#ifdef MPI
CALL MPI_INIT(iError)
IF(iError .NE. 0) &
  CALL Abort(__STAMP__, &
       'Error in MPI_INIT',iError)

CALL MPI_COMM_RANK(MPI_COMM_WORLD, myRank     , iError)
CALL MPI_COMM_SIZE(MPI_COMM_WORLD, nProcessors, iError)
IF(iError .NE. 0) &
  CALL Abort(__STAMP__, &
      'Could not get rank and number of processors',iError)
MPIRoot=(myRank .EQ. 0)
#else  /*MPI*/
myRank      = 0 
nProcessors = 1 
MPIRoot     =.TRUE.
#endif  /*MPI*/

! At this point the initialization is not completed. We first have to create a new MPI communicator. MPIInitIsDone will be set
END SUBROUTINE InitMPI


END MODULE MODH_MPI
